// https://atcoder.jp/contests/abc232/tasks/abc232_d

use std::cmp::max;

pub fn run(h: usize, w: usize, c: Vec<&str>) -> i32 {
    let vec: Vec<Vec<char>> = c.iter().map(|str| str.chars().collect()).collect();

    let mut dp = vec![vec![-1; w]; h];

    dp[0][0] = 1;

    for i in 0..h {
        for j in 0..w {
            if i == 0 && j == 0 {
                continue;
            }

            if vec[i][j] == '#' {
                continue;
            }

            if i == 0 {
                dp[i][j] = dp[i][j-1] + 1;
            } else if j == 0 {
                dp[i][j] = dp[i-1][j] + 1;
            } else {
                dp[i][j] = max(dp[i][j-1], dp[i-1][j]) + 1;
            }
        }
    }

    *dp.iter()
        .map(|d| d.iter().max().unwrap())
        .max()
        .unwrap()
}

#[cfg(test)]
mod tests {
    use super::*;

    struct TestCase(usize, usize, Vec<&'static str>, i32);

    #[test]
    fn test() {
        let tests = [
            TestCase(3, 4, vec![".#..", "..#.", "..##"], 4),
            TestCase(5, 5, vec![".....", ".....", ".....", ".....", "....."], 9),
            TestCase(100, 100, vec!["....................................................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".#..................................................................................................",
                                    ".#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".#..................................................................................................",
                                    ".#.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...#................................................................................................",
                                    ".#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".......#............................................................................................",
                                    ".#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".........#..........................................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...........#........................................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...........#........................................................................................",
                                    ".#.#.#.#.#.#.#######.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...........#........................................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".................#..................................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".................#..................................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".....................#..............................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.###########.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".....................#..............................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...............................#....................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...............................#....................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".................................#..................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...................................#................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...................................#................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...................................#................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...................................#................................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".....................................#..............................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".....................................#..............................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".....................................#..............................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".....................................#..............................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".......................................#............................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".......................................#............................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".......................................#............................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".........................................#..........................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".........................................#..........................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...........................................#........................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...........................................#........................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".............................................#......................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".............................................#......................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".............................................#......................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...............................................#....................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...............................................#....................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#################.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...................................................#................................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...................................................................#................................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".....................................................................#..............................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".....................................................................#..............................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".......................................................................#............................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###########.#.#.#.#.#.#.#",
                                    ".........................................................................#..........................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...................................................................................#................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    "...................................................................................#................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.#.#.#.#.#",
                                    "...................................................................................#................",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#",
                                    ".......................................................................................#............",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".........................................................................................#..........",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.#.#",
                                    ".........................................................................................#..........",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#",
                                    ".............................................................................................#......",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#####",
                                    ".............................................................................................#......",
                                    ".#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#"], 198),
            TestCase(55, 74, vec!["..#..#.###.........##..#......#.#..#..#..#..#.#..##....#............##..##",
                                    "...#......#.#...#..#..............##.#.#..#.#...#...#..#.#....#.#..#.#.#..",
                                    ".#.###..#...####........#.#.#...#.##.........#.#.#.#.....#...##.....###...",
                                    "..#.#.#..#####....##...##..........#.........####......#..#..#..#...#.#.#.",
                                    ".#.###.#..#......#...#..###.##...##......###..#..#..#..##..#..#.....##..#.",
                                    ".#...##.#.##..#..#.#...##..........................#.###...#....#..#.##...",
                                    ".....#...#....#.###.................#...##........##..#..#..#..#...##...#.",
                                    "##.#.##...#..###....#.....##..#........#.#.#..#.#..###.....#....##........",
                                    ".......#.#....................####..##..#.....#...#.##......##.#..##.....#",
                                    ".#..##..#.....#....................##..##..#.#.........#....#.#.#..##..#..",
                                    "#....#.........#......#.#...##...#..#..###..#.##.#..#.#.....#........##...",
                                    ".#...##..#....#....###..#..#.#....#.#.#..#...#...##..#..#.#..#.......##..#",
                                    "....#.....#.##...#...........####..#.......#####.#.#..#....#..#.####.###..",
                                    "##..#....##..#...#..#.....##.#...#........##.......#.#.......###...#....#.",
                                    "#..##........#..##.#.#.#...##...#...##..##.#.##.....#..#.....##.........#.",
                                    "#...#....##......##.#....####.###........##.#.#.........###.###.##......#.",
                                    ".....#.#.##.#....#.#.#...#.#..#..##...#.#..#..#####.##.##...##.###.......#",
                                    "###...####....###.##......#....#.##..#...##.#..##.#.#...##..##......#.....",
                                    ".##.#..#..#.##..#..##...#...#...#.##.##....#..###.#..##..#.....#..#......#",
                                    "......#####...#...#.##.#..###.###...#...##.....#.....#.##..###....#.#.#..#",
                                    "..##.....#..##.#.##...##.#..#....#..#.#......#...#......##..###.##.#..#...",
                                    "#.#..##........#.######..#....#...#....#....###..#...##.##.#...##..#......",
                                    ".##..####.#............#....#.#.....########....#...#.####..##....#..#.##.",
                                    "#..#.#.#..#..#..#...##...###.#.....#...#...#.#....#.#.#...#..##.#.##..#..#",
                                    "...#.##....##..#.#..#.####..#.......#.#..#...###.###.#.....#.#.##.#.#.#...",
                                    "#...#...#........#.###...........#......###...#...#.....#...##..#..##...##",
                                    ".#.#....#...##..#.#.##.##..##....#......#.......#####..#.#................",
                                    "....###.#.#......#........####....#.#.#.......#.#.##...##.......#..#......",
                                    "#..#..#....###......###...#....##...#.###...###..#......#...#....##.......",
                                    ".#...#.....#....#.##.##.....#.#...#..#...###..............#.#..#....#....#",
                                    "#....#.#.##..#.#...#..#...###.##..##.#..#.........#..##..#......#..#.....#",
                                    "##...##........#......#.#...#.#........#..#.#.......####.#.####.#.......##",
                                    "..#...####.#.....#..#...##...#..#.#...#..##.#...###.#...##..#........#.##.",
                                    "..##.##..........#.#.....#..##.###...#.....#....#.#..#.#..#......#.....#.#",
                                    "......###...###..#..##.###.#.#...#.#..........##.#...####.....#...####...#",
                                    ".##.....#........#.#...#..........#.....#.####.#....#.....##...#.#.......#",
                                    ".#....#......##..####..#.....###.#..#..#.#.....##.#.#...##.#.#.#...#..#...",
                                    "..#..#.##..##.....#.#.#.#.#......##.....#....##..###.#.....###.##.#.###...",
                                    "###.##..#..##.....#.#..#.#...#..#......#.#.##.#..###....#..#.....#.....#..",
                                    "........#####...#.#......##..#.......##...#......#.....#...#....#.#...###.",
                                    "#.#..#.......#...##.###.##...#.#.###.....#####....#.##...#......#.#..#..#.",
                                    "#..###.#..##.##..#.#..........#...####..........##.##.#...#..##..#.##..#..",
                                    "..#.##.#...##..........#.##.#.##......##.#.#.#.#...##.##.#.....##.##..#.#.",
                                    ".............##..###.#.##.....#.#.#.....#.#.##...#.#..##...#.####....#..#.",
                                    "...#.....#...#.###.##.#....#.##..#.....#..##..###.#.#...#.#.#.#.###.......",
                                    ".#.#..........#.#.......##.#....##.#.#...#.#..###............##.....##.###",
                                    ".........#...#.#..#......#..#...##..##.#...##..........#..#.#..####.....##",
                                    ".#....#....#.#..#.#.....#........#.###.#.....###.#....#........#..#....##.",
                                    ".#.#....##...###.#..##...##.#.#....#..#..#.....##..#.#..#.#.#..##.#...##.#",
                                    "#....##.#..#....#...#..####...##.#.##.##.##.#.#...............###.##...#..",
                                    ".#.###.#.#.#..#.....#...#.#....###..#....#...#.#..#.#.##.........###.#....",
                                    "..#.#.####..##....###.......##.#.######.##...##.##....#...#........#..#..#",
                                    "....#..#.....##.#.#####..#.#..###....#..........#.#....##...#####..#...#..",
                                    "..##.....#....##.##..#...#..####.#...###.....#...#...#.......#.#....#.##..",
                                    "...###......#.#...#.#..#....#....#..#..#....##.....#.#.......##....#..#.#."], 66),
        ];

        for TestCase(h, w, c, expected) in tests {
            assert_eq!(run(h, w, c), expected);
        }
    }
}
